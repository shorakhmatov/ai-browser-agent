# AI Browser Agent

Автономный AI-агент для управления веб-браузером и выполнения сложных многошаговых задач.

## Особенности

- **Автономное управление браузером** - агент самостоятельно принимает решения и выполняет действия
- **Видимый браузер** - полный контроль над Chromium браузером в режиме реального времени
- **Intelligent tool calling** - агент анализирует страницу и выбирает правильные действия
- **Обработка ошибок** - адаптивное поведение при неудачах
- **Security layer** - запрос подтверждения для деструктивных действий
- **Context management** - оптимизация работы с ограничениями по токенам
- **Persistent sessions** - поддержка сохранения состояния браузера

## Требования

- Python 3.8+
- Anthropic API ключ (Claude 3.5 Sonnet)

## Установка

```bash
pip install -r requirements.txt
playwright install
```

## Настройка

1. Создайте `.env` файл на основе `.env.example`:
```bash
cp .env.example .env
```

2. Добавьте ваш Anthropic API ключ:
```
ANTHROPIC_API_KEY=your_key_here
```

## Использование

### Интерактивный режим

```bash
python cli.py
```

Команды:
- `task <описание>` - выполнить задачу
- `screenshot <путь>` - сделать скриншот
- `url` - получить текущий URL
- `exit` - выход

### Выполнение одной задачи

```bash
python cli.py "найти и заполнить форму на примере.com"
```

### Прямое использование в коде

```python
import asyncio
from ai_agent import AIAgent

async def main():
    agent = AIAgent("your-api-key")
    await agent.initialize()
    
    result = await agent.execute_task("ваша задача")
    print(result)
    
    await agent.close()

asyncio.run(main())
```

## Архитектура

### Основные компоненты

- **BrowserController** (`browser_controller.py`) - управление браузером через Playwright
- **AIAgent** (`ai_agent.py`) - основной агент с логикой принятия решений
- **ContextManager** (`context_manager.py`) - оптимизация контекста для API
- **ErrorHandler** (`error_handler.py`) - обработка и восстановление от ошибок
- **CLI** (`cli.py`) - интерфейс командной строки

### Доступные инструменты

- `navigate(url)` - перейти на URL
- `click(selector)` - клик по элементу
- `type(selector, text)` - ввод текста
- `scroll(direction, amount)` - прокрутка страницы
- `wait(seconds)` - ожидание
- `extract_text()` - получить текст страницы
- `get_elements()` - получить интерактивные элементы
- `screenshot(path)` - сделать скриншот
- `get_url()` - получить текущий URL

## Примеры задач

```
"Найди форму регистрации и заполни её"
"Перейди на сайт example.com и найди цену товара"
"Добавь товар в корзину и оформи заказ"
"Найди и скопируй информацию о контактах"
```

## Как это работает

1. Агент получает задачу от пользователя
2. Анализирует текущее состояние страницы
3. Определяет необходимые действия
4. Выполняет инструменты (click, type, scroll и т.д.)
5. Получает результаты и анализирует изменения
6. Повторяет процесс до завершения задачи

## Безопасность

Агент запрашивает подтверждение перед выполнением деструктивных действий:
- Отправка форм
- Удаление элементов
- Оплата
- Другие критические операции

## Ограничения

- Максимум 15 итераций на задачу
- Контекст ограничен 8000 токенов
- Требует видимого браузера (не headless)
- Зависит от качества CSS селекторов на странице

## Лицензия

MIT
